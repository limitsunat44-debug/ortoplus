<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OrtoPlus - –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</title>
    <link rel="stylesheet" href="admin-styles.css">
</head>
<body>
    <div class="admin-container">
        <div class="admin-login" id="adminLogin">
            <div class="login-form">
                <h1>–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å OrtoPlus</h1>
                <div class="form-group">
                    <input type="text" id="adminUsername" placeholder="–õ–æ–≥–∏–Ω" required>
                </div>
                <div class="form-group">
                    <input type="password" id="adminPassword" placeholder="–ü–∞—Ä–æ–ª—å" required>
                </div>
                <button onclick="adminLogin()" class="btn-login">–í–æ–π—Ç–∏</button>
                <div id="loginError" class="error-message"></div>
            </div>
        </div>

        <div class="admin-dashboard" id="adminDashboard" style="display: none;">
            <header class="dashboard-header">
                <h1>–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h1>
                <div class="header-controls">
                    <span class="admin-info">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä: <span id="currentAdmin"></span></span>
                    <button onclick="adminLogout()" class="btn-logout">–í—ã–π—Ç–∏</button>
                </div>

                <!-- –î–û–ë–ê–í–¨–¢–ï –≠–¢–û –í admin-panel.html –ü–û–°–õ–ï –°–ï–ö–¶–ò–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø–ú–ò -->

<!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è —Ä–∞—Å—Å—ã–ª–∫–∏ -->
<div class="broadcast-section">
    <h2>üì± SMS –†–∞—Å—Å—ã–ª–∫–∞</h2>
    <button onclick="openBroadcastModal()" class="btn-broadcast">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É</button>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–∞—Å—Å—ã–ª–∫–∏ -->
<div class="modal" id="broadcastModal">
    <div class="modal-content broadcast-modal">
        <div class="modal-header">
            <h3>üì± SMS –†–∞—Å—Å—ã–ª–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞–º</h3>
            <span class="close-btn" onclick="closeBroadcastModal()">&times;</span>
        </div>
        
        <div class="modal-body">
            <!-- –ü–æ–ª—É—á–∞—Ç–µ–ª–∏ -->
            <div class="form-group">
                <label>–ü–æ–ª—É—á–∞—Ç–µ–ª–∏:</label>
                <select id="broadcastRecipients" onchange="updateRecipientCount()">
                    <option value="all">–í—Å–µ –∫–ª–∏–µ–Ω—Ç—ã</option>
                    <option value="today">–ù–æ–≤—ã–µ –∫–ª–∏–µ–Ω—Ç—ã (—Å–µ–≥–æ–¥–Ω—è)</option>
                    <option value="week">–ù–æ–≤—ã–µ –∫–ª–∏–µ–Ω—Ç—ã (–∑–∞ –Ω–µ–¥–µ–ª—é)</option>
                    <option value="active">–ê–∫—Ç–∏–≤–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã (–∑–∞ –º–µ—Å—è—Ü)</option>
                </select>
                <span class="recipient-count">–ü–æ–ª—É—á–∞—Ç–µ–ª–µ–π: <strong id="recipientCount">0</strong></span>
            </div>
            
            <!-- –®–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π -->
            <div class="form-group">
                <label>–ë—ã—Å—Ç—Ä—ã–µ —à–∞–±–ª–æ–Ω—ã:</label>
                <div class="template-buttons">
                    <button onclick="applyMessageTemplate('welcome')" class="btn-template">–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ</button>
                    <button onclick="applyMessageTemplate('promo')" class="btn-template">–ê–∫—Ü–∏—è</button>
                    <button onclick="applyMessageTemplate('reminder')" class="btn-template">–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ</button>
                    <button onclick="applyMessageTemplate('newProduct')" class="btn-template">–ù–æ–≤–∏–Ω–∫–∞</button>
                </div>
            </div>
            
            <!-- –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è -->
            <div class="form-group">
                <label>–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è:</label>
                <textarea id="broadcastMessage" 
                         placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç SMS —Å–æ–æ–±—â–µ–Ω–∏—è..." 
                         rows="4" 
                         oninput="updateCharacterCount()"></textarea>
                <div class="character-count">
                    <span id="characterCount">0/160</span>
                    <small>–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ 160 —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –æ–¥–Ω–æ–≥–æ SMS</small>
                </div>
            </div>
            
            <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å —Ä–∞—Å—Å—ã–ª–∫–∏ -->
            <div class="broadcast-progress" id="broadcastProgressContainer" style="display: none;">
                <label>–ü—Ä–æ–≥—Ä–µ—Å—Å —Ä–∞—Å—Å—ã–ª–∫–∏:</label>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="broadcastProgress"></div>
                </div>
                <div class="progress-info">
                    <span id="broadcastProgressText">0 / 0</span>
                    <span id="currentUser"></span>
                </div>
            </div>
        </div>
        
        <div class="modal-footer">
            <button onclick="startBroadcast()" id="startBroadcastBtn" class="btn-send">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É</button>
            <button onclick="stopBroadcast()" id="stopBroadcastBtn" class="btn-stop" disabled>üõë –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
            <button onclick="closeBroadcastModal()" class="btn-cancel">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>
</div>
            </header>

            <div class="dashboard-content">
                <div class="stats-section">
                    <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="totalUsers">0</div>
                            <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="newUsersToday">0</div>
                            <div class="stat-label">–ù–æ–≤—ã—Ö —Å–µ–≥–æ–¥–Ω—è</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="activeUsers">0</div>
                            <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                        </div>
                    </div>
                </div>

                <div class="users-section">
                    <div class="section-header">
                        <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h2>
                        <div class="controls">
                            <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É –∏–ª–∏ –∏–º–µ–Ω–∏..." onkeyup="filterUsers()">
                            <button onclick="refreshUserList()" class="btn-refresh">–û–±–Ω–æ–≤–∏—Ç—å</button>
                        </div>
                    </div>
                    
                    <div class="users-table-container">
                        <table class="users-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>–ò–º—è</th>
                                    <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                                    <th>Email</th>
                                    <th>EAN –∫–æ–¥</th>
                                    <th>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="usersTableBody">
                                <!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
        <div class="modal" id="editUserModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                    <span class="close-btn" onclick="closeEditModal()">&times;</span>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="editUserId">
                    <div class="form-group">
                        <label>–ò–º—è:</label>
                        <input type="text" id="editUserName">
                    </div>
                    <div class="form-group">
                        <label>–¢–µ–ª–µ—Ñ–æ–Ω:</label>
                        <input type="text" id="editUserPhone">
                    </div>
                    <div class="form-group">
                        <label>Email:</label>
                        <input type="email" id="editUserEmail">
                    </div>
                    <div class="form-group">
                        <label>EAN –∫–æ–¥:</label>
                        <input type="text" id="editUserEAN" maxlength="13">
                    </div>
                    <div class="form-group">
                        <label>–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ —à—Ç—Ä–∏—Ö–∫–æ–¥–∞:</label>
                        <input type="file" id="barcodeImage" accept="image/*" onchange="previewBarcodeImage()">
                        <div id="barcodePreview" class="barcode-preview"></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button onclick="saveUserChanges()" class="btn-save">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button onclick="closeEditModal()" class="btn-cancel">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>

         <div class="modal" id="addUserModal">
//   <div class="modal-content">
//     <div class="modal-header">
//       <h3>–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
//       <span class="close-btn" onclick="closeAddUserModal()">&times;</span>
//     </div>
//     <div class="modal-body">
//       <div class="form-group">
//         <label>–ò–º—è:</label>
//         <input type="text" id="addUserName">
//       </div>
//       <div class="form-group">
//         <label>–¢–µ–ª–µ—Ñ–æ–Ω:</label>
//         <input type="text" id="addUserPhone">
//       </div>
//       <div class="form-group">
//         <label>EAN-13:</label>
//         <input type="text" id="addUserEAN" maxlength="13">
//         <button onclick="document.getElementById('addUserEAN').value=generateEAN13()" class="btn-secondary">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —à—Ç—Ä–∏—Ö–∫–æ–¥</button>
//       </div>
//       <div class="form-group">
//         <label>–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —à—Ç—Ä–∏—Ö–∫–æ–¥–∞:</label>
//         <input type="file" id="addBarcodeImage" accept="image/*" onchange="previewAddBarcodeImage()">
//         <div id="addBarcodePreview"></div>
//       </div>
//     </div>
//     <div class="modal-footer">
//       <button onclick="addNewUser()" class="btn-save">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
//       <button onclick="closeAddUserModal()" class="btn-cancel">–û—Ç–º–µ–Ω–∞</button>
//     </div>
//   </div>
// </div>

	<!-- –î–û–ë–ê–í–¨–¢–ï –≠–¢–ò –ö–ù–û–ü–ö–ò –í –í–ê–®–£ –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ -->
<div class="backup-controls" style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
    <h3 style="margin-top: 0;">üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—ç–∫–∞–ø–æ–º</h3>
    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
        <button onclick="showBackupInfo()" style="padding: 10px 20px; background: #17a2b8; color: white; border: none; border-radius: 5px; cursor: pointer;">
            üìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±—ç–∫–∞–ø–µ
        </button>
        <button onclick="restoreFromBackup()" style="padding: 10px 20px; background: #ffc107; color: #000; border: none; border-radius: 5px; cursor: pointer;">
            üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞
        </button>
        <button onclick="exportBackupToFile()" style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer;">
            üíæ –≠–∫—Å–ø–æ—Ä—Ç –±—ç–∫–∞–ø–∞
        </button>
    </div>
    <p style="margin-bottom: 0; margin-top: 10px; font-size: 12px; color: #666;">
        ‚ÑπÔ∏è –ë—ç–∫–∞–ø —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –æ–±–ª–∞–∫–æ
    </p>
</div>

// ========== –ö–ù–û–ü–ö–ê –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è =========
// –ù–∞–ø—Ä–∏–º–µ—Ä, –æ–∫–æ–ª–æ H2 "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏":
// <button onclick="openAddUserModal()" class="btn-primary">+ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è -->
        <div class="modal" id="deleteConfirmModal">
            <div class="modal-content small">
                <div class="modal-header">
                    <h3>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è</h3>
                </div>
                <div class="modal-body">
                    <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?</p>
                    <input type="hidden" id="deleteUserId">
                </div>
                <div class="modal-footer">
                    <button onclick="confirmDeleteUser()" class="btn-delete">–£–¥–∞–ª–∏—Ç—å</button>
                    <button onclick="closeDeleteModal()" class="btn-cancel">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>
    </div>

    <script src="admin-script.js"></script>
</body>
</html>
